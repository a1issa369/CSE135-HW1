cat > /var/www/html/hw2/forms/echo-form.html <<'HTML'
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HW2 Echo Form</title>
  <style>
    body { font-family: system-ui, -apple-system, sans-serif; max-width: 860px; margin: 2rem auto; padding: 0 1rem; }
    label { display:block; margin-top: 1rem; font-weight: 600; }
    select, input, button { width: 100%; padding: .6rem; margin-top: .35rem; }
    .row { display:grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
    .hint { color:#444; font-size:.95rem; }
  </style>
</head>
<body>
  <h1>HW2 Echo Form</h1>
  <p class="hint">
    <strong>JS off:</strong> still works (POST + form-urlencoded to PHP).<br>
    <strong>JS on:</strong> choose endpoint + method (GET/POST/PUT/DELETE) + encoding (form/json).
  </p>

  <form id="echoForm" action="/hw2/php/echo-php.php" method="post">
    <div class="row">
      <div>
        <label for="language">Language (endpoint)</label>
        <select id="language" name="language">
          <option value="php" selected>PHP</option>
          <option value="python">Python</option>
          <option value="c">C</option>
        </select>
      </div>

      <div>
        <label for="method">HTTP Method</label>
        <select id="method" name="method">
          <option value="POST" selected>POST</option>
          <option value="GET">GET</option>
          <option value="PUT">PUT</option>
          <option value="DELETE">DELETE</option>
        </select>
      </div>
    </div>

    <label for="encoding">Encoding</label>
    <select id="encoding" name="encoding">
      <option value="form" selected>application/x-www-form-urlencoded</option>
      <option value="json">application/json</option>
    </select>

    <label for="msg">Message</label>
    <input id="msg" name="msg" placeholder="type something..." />

    <label for="extra">Extra Field</label>
    <input id="extra" name="extra" placeholder="anything else..." />

    <button type="submit">Send</button>
  </form>

  <script>
    const form = document.getElementById('echoForm');
    const language = document.getElementById('language');
    const methodSel = document.getElementById('method');
    const encodingSel = document.getElementById('encoding');

    function endpointFor(lang) {
      if (lang === 'php') return '/hw2/php/echo-php.php';
      if (lang === 'python') return '/cgi-bin/hw2/python/echo-python.py';
      if (lang === 'c') return '/cgi-bin/hw2/c/echo.cgi';
      return '/hw2/php/echo-php.php';
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const lang = language.value;
      const method = methodSel.value;
      const enc = encodingSel.value;

      const url = endpointFor(lang);
      const msg = document.getElementById('msg').value;
      const extra = document.getElementById('extra').value;

      let fetchOpts = { method, headers: {} };
      let finalUrl = url;

      if (method === 'GET') {
        finalUrl = url + '?' + new URLSearchParams({ msg, extra }).toString();
      } else {
        if (enc === 'json') {
          fetchOpts.headers['Content-Type'] = 'application/json';
          fetchOpts.body = JSON.stringify({ msg, extra });
        } else {
          fetchOpts.headers['Content-Type'] = 'application/x-www-form-urlencoded';
          fetchOpts.body = new URLSearchParams({ msg, extra }).toString();
        }
      }

      const res = await fetch(finalUrl, fetchOpts);
      const text = await res.text();

      document.open();
      document.write(text);
      document.close();
    });
  </script>
</body>
</html>
HTML
